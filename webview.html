<meta charset="UTF-8">
<title>webview jsbridge检测</title>

<script type="text/javascript">
// function getContents(inputStream)
// {
// 	var contents = "";
// 	var b = inputStream.read();
// 	while(b != -1) {
//     	var bString = String.fromCharCode(b);
//     	contents += bString;
//     	contents += "\n"
//     	b = inputStream.read();
// 	}
// 	return contents;
// }

function check() {
	var origin = 'caches,localStorage,sessionStorage,webkitStorageInfo,indexedDB,webkitIndexedDB,ondeviceorientationabsolute,ondeviceorientation,ondevicemotion,crypto,stop,open,alert,confirm,prompt,print,requestAnimationFrame,cancelAnimationFrame,requestIdleCallback,cancelIdleCallback,captureEvents,releaseEvents,getComputedStyle,matchMedia,moveTo,moveBy,resizeTo,resizeBy,getSelection,postMessage,find,blur,focus,getMatchedCSSRules,close,webkitRequestAnimationFrame,webkitCancelAnimationFrame,ontouchstart,webkitCancelRequestAnimationFrame,ontouchmove,ontouchend,ontouchcancel,btoa,onpointerup,atob,onpointerover,setTimeout,onpointerout,onpointermove,clearTimeout,onpointerleave,onpointerenter,onpointerdown,setInterval,onpointercancel,clearInterval,createImageBitmap,onorientationchange,scroll,orientation,scrollTo,scrollBy,customElements,onauxclick,performance,fetch,onunload,onunhandledrejection,console,onstorage,getContents,onrejectionhandled,onpopstate,check,onpageshow,onpagehide,ononline,onoffline,onmessage,onlanguagechange,onhashchange,onbeforeunload,onwaiting,onvolumechange,ontoggle,ontimeupdate,onsuspend,onsubmit,onstalled,onshow,onselect,onseeking,onseeked,onscroll,onresize,onreset,onratechange,onprogress,onplaying,onplay,onpause,onmousewheel,onmouseup,onmouseover,onmouseout,onmousemove,onmouseleave,onmouseenter,onmousedown,onloadstart,onloadedmetadata,onloadeddata,onload,onkeyup,onkeypress,onkeydown,oninvalid,oninput,onfocus,onerror,onended,onemptied,ondurationchange,ondrop,ondragstart,ondragover,ondragleave,ondragenter,ondragend,ondrag,ondblclick,oncuechange,oncontextmenu,onclose,onclick,onchange,oncanplaythrough,oncanplay,oncancel,onblur,onabort,isSecureContext,onwheel,onwebkittransitionend,onwebkitanimationstart,onwebkitanimationiteration,onwebkitanimationend,ontransitionend,onsearch,onanimationstart,onanimationiteration,onanimationend,styleMedia,defaultstatus,defaultStatus,screenTop,screenLeft,clientInformation,devicePixelRatio,outerHeight,outerWidth,screenY,screenX,pageYOffset,scrollY,pageXOffset,scrollX,innerHeight,innerWidth,screen,external,applicationCache,navigator,frameElement,parent,opener,top,length,frames,closed,status,toolbar,statusbar,scrollbars,personalbar,menubar,locationbar,history,location,name,document,self,window,TEMPORARY,PERSISTENT,addEventListener,removeEventListener,dispatchEvent';
	
	var u = navigator.userAgent;
	var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1;
	
	if(!isAndroid){
		document.write('IOS:<br>');
		if(window.OCModel == undefined){
			alert('no uiwebview')
		}else{
			for (var o in window.OCModel) {
				document.write(o+':<br>');
			}
		}
		
		if(window.webkit == undefined){
			alert('no wkwebview')
		}else{
			for (var o in window.webkit.messageHandlers) {
				document.write(o+':<br>');
			}
		}					

		return;
	}

	for (var obj in window){
    	if(origin.indexOf(obj)<0){
	    	document.write(obj+':<br>');
	    	for (var o in window[obj]) {
	    		document.write('&nbsp;&nbsp;'+o+'<br>');
	    	}
	    }
    }
    // document.write('<br>dangerous:<');
    // try {
    //   	if ("getClass" in window[obj]) { 
    //     	alert(obj);
    //     	try{ 
    //       		window[obj].getClass();
    //       		document.write('<b>'+obj+'</b><br>');
    //       		var p = window[obj].getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(["id"]);
    //       		document.write(getContents(p.getInputStream())+'<br>');
    //     	}catch(e){
    //   		} 
    //   	} 
    // } catch(e) {
    // }
}
check();
</script>
